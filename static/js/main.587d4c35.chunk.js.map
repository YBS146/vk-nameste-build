{"version":3,"sources":["App.js","index.js"],"names":["App","props","callAPI","method","params","state","vkAccessToken","connectPromise","send","then","data","response","catch","error","getGroups","connect","getToken","onRefresh","activePanel","activeStory","activeView","appInitTimestamp","fetching","fetchedUser","isAuthorized","userAllowedScopes","userData","userDiscoverFeed","userFriends","userFriendsInApp","userGeodata","userGroups","onPanelChange","bind","onStoryChange","onViewChange","this","setState","getTimestamp","subscribe","e","detail","hasOwnProperty","type","console","log","Axios","get","id","lat","lng","long","access_token","getFriends","request_id","post","items","feedItems","forEach","value","name","city","title","push","getAppRuntime","warn","Math","floor","Date","now","currentTarget","dataset","panel","story","view","isWebView","tabbar","onClick","selected","data-story","text","length","style","paddingTop","size","marginTop","textAlign","map","item","i","key","slideWidth","height","bullets","backgroundColor","description","before","src","photo_200","color","first_name","last_name","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.587d4c35.chunk.js","sourcesContent":["import React from 'react';\n\n// libs\nimport Axios from 'axios';\n\n// VK\nimport connect from '@vkontakte/vk-connect';\nimport connectPromise from \"@vkontakte/vkui-connect-promise\";\nimport { \n\tAvatar,\n\tButton,\n\tCell,\n\tConfigProvider,\n\tDiv,\n\tEpic,\n\tGallery,\n\tGroup,\n\tList,\n\tPanel,\n\tPanelHeader,\n\tPullToRefresh,\n\tSpinner,\n\tTabbar,\n\tTabbarItem,\n\tUsersStack,\n\tView\n} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n// import { IS_PLATFORM_ANDROID, IS_PLATFORM_IOS } from '@vkontakte/vkui/dist/lib/platform';\n\n\nimport Icon16Like from '@vkontakte/icons/dist/16/like';\nimport Icon28Newsfeed from '@vkontakte/icons/dist/28/newsfeed';\nimport Icon28User from '@vkontakte/icons/dist/28/profile';\nimport Icon28Users from '@vkontakte/icons/dist/28/users';\n//import Map from './components/Map';\n\n// styles\nimport './styles/App.css';\n\nconst APP_NAME = 'НаМесте';\nconst ENABLE_DEBUG = true;\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\t// app\n\t\t\tactivePanel: 'discover',\n\t\t\tactiveStory: 'discover',\n\t\t\tactiveView: 'discover',\n\t\t\tappInitTimestamp: 0,\n\t\t\tfetching: false,\n\n\t\t\t// user\n\t\t\tfetchedUser: null,\n\t\t\tisAuthorized: false,\n\n\t\t\tuserAllowedScopes: false, // TODO\n\n\t\t\tuserData: [],\n\t\t\tuserDiscoverFeed: [],\n\t\t\tuserFriends: [],\n\t\t\tuserFriendsInApp: [],\n\t\t\tuserGeodata: null,\n\t\t\tuserGroups: [],\n\t\t\tvkAccessToken: null,\n\t\t};\n\n\t\tthis.onPanelChange = this.onPanelChange.bind(this);\n\t\tthis.onStoryChange = this.onStoryChange.bind(this);\n\t\tthis.onViewChange = this.onViewChange.bind(this);\n\n\t\tthis.onRefresh = this.onRefresh.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\t//console.log(this.state);\n\n\t\tthis.setState({\n\t\t\tappInitTimestamp: this.getTimestamp(),\n\t\t});\n\n\t\t// VK CONNECT\n\t\tconnect.subscribe((e) => {\n\t\t\tif (e.detail.hasOwnProperty('type')) {\n\t\t\t\tswitch (e.detail.type) {\n\t\t\t\t\tcase 'VKWebAppGetUserInfoResult':\n\t\t\t\t\t\t// save user data\n\t\t\t\t\t\tconsole.log(e.detail.data);\n\t\t\t\t\t\tthis.setState({ fetchedUser: e.detail.data });\n\t\n\t\t\t\t\t\t// auth user\n\t\t\t\t\t\tAxios.get('https://ybsapi.herokuapp.com/user/authorize/' + e.detail.data.id)\n\t\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\t\tconsole.log('! YBS-API: user/authorize');\n\n\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty('data')) {\n\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\tisAuthorized: true\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\tconsole.log(response.data.data);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// TODO: error message\n\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\tconsole.log('! Auth: Failed!');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\tconsole.log('ERROR: ' + error);\n\t\t\t\t\t\t\t\t\t//console.error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'VKWebAppGeodataResult':\n\t\t\t\t\t\t// console.log('! Result: Geodata');\n\t\t\t\t\t\t// console.log(e.detail.data.lat + ',' + e.detail.data.long);\n\n\t\t\t\t\t\tthis.setState({ \n\t\t\t\t\t\t\tuserGeodata: {\n\t\t\t\t\t\t\t\tlat: e.detail.data.lat,\n\t\t\t\t\t\t\t\tlng: e.detail.data.long\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'VKWebAppAccessTokenReceived':\n\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\tconsole.log('! Result: AccessToken');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (e.detail.data.hasOwnProperty('access_token')) {\n\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\tvkAccessToken: e.detail.data.access_token\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tthis.getFriends();\n\t\t\t\t\t\t\tthis.getGroups();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\tconsole.log('ACCESS_TOKEN_ERROR');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'VKWebAppCallAPIMethodResult':\n\t\t\t\t\t\tif (e.detail.data.hasOwnProperty('request_id')) {\n\t\t\t\t\t\t\tswitch (e.detail.data.request_id) {\n\t\t\t\t\t\t\t\tcase '1fr':\n\t\t\t\t\t\t\t\t\t// TODO: УДАЛИТЬ НАХУЙ\n\t\t\t\t\t\t\t\t\tconst SEND_FRIENDS_GROUPS = false;\n\t\t\t\t\t\t\t\t\tif (SEND_FRIENDS_GROUPS) {\n\t\t\t\t\t\t\t\t\t\tlet few_friends = e.detail.data.response.items; //e.detail.data.response.items.slice(10, 20);\n\n\t\t\t\t\t\t\t\t\t\tconsole.log('! FEW');\n\n\t\t\t\t\t\t\t\t\t\tfew_friends.forEach(value => {\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('! friend user_id: ' + value.id);\n\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(this.callAPI('groups.get', {\n\t\t\t\t\t\t\t\t\t\t\t\t'user_id': value.id,\n\t\t\t\t\t\t\t\t\t\t\t\t'fields': 'city,country,place,description,members_count,links,site,is_favorite,photo_100,photo_200',\n\t\t\t\t\t\t\t\t\t\t\t\t'count': 50,\n\t\t\t\t\t\t\t\t\t\t\t\t'extended': true,\n\t\t\t\t\t\t\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t\t\t\t\t\t\tAxios.post('https://ybsapi.herokuapp.com/user/communities/' + value.id, response.items)\n\t\t\t\t\t\t\t\t\t\t\t\t\t.then(resp => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('ERROR: ' + error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// send friends\n\t\t\t\t\t\t\t\t\tAxios.post('https://ybsapi.herokuapp.com/user/friends/' + this.state.fetchedUser.id, e.detail.data.response.items)\n\t\t\t\t\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('! YBS-API: user/friends');\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty('data')) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(response.data.data);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\t\t\t\tuserFriendsInApp: response.data.data,\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('ERROR: ' + error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tthis.setState({ \n\t\t\t\t\t\t\t\t\t\tuserFriends: e.detail.data.response.items \n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\t\tcase '1gr':\n\t\t\t\t\t\t\t\t\t// send groups\n\t\t\t\t\t\t\t\t\tAxios.post('https://ybsapi.herokuapp.com/user/communities/' + this.state.fetchedUser.id, e.detail.data.response.items)\n\t\t\t\t\t\t\t\t\t\t.then(response => {\n\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('! YBS-API: user/communities');\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tif (response.data.hasOwnProperty('data')) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(response.data.data);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t// prepare feed\n\t\t\t\t\t\t\t\t\t\t\t\tlet feedItems = [];\n\t\t\t\t\t\t\t\t\t\t\t\tresponse.data.data.forEach(value => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (value.hasOwnProperty('name') && value.name !== (this.state.fetchedUser.city.title || '')) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfeedItems.push(value);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\t\t\t\tuserDiscoverFeed: feedItems //response.data.data,\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(this.getAppRuntime());\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('ERROR: ' + error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tthis.setState({ \n\t\t\t\t\t\t\t\t\t\tuserGroups: e.detail.data.response.items \n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// debug\n\t\t\t\t\t\tif (ENABLE_DEBUG) {\n\t\t\t\t\t\t\tconsole.warn(e.detail.type);\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tconnect.send('VKWebAppGetUserInfo', {});\n\t\t//connect.send('VKWebAppGetGeodata', {});\n\n\t\tthis.getToken();\n\t}\n\n\tcallAPI = (method, params) => {\n\t\tparams['access_token'] = this.state.vkAccessToken;\n\t\tparams['v'] = '5.101';\n\t\n\t\treturn connectPromise.send('VKWebAppCallAPIMethod', {\n\t\t\t'method': method,\n\t\t\t'params': params\n\t\t}).then(data => {\n\t\t\treturn data.data.response;\n\t\t}).catch(error => {\n\t\t\treturn error;\n\t\t});\n\t};\n\n\tgetAppRuntime() {\n\t\treturn (this.getTimestamp() - this.state.appInitTimestamp);\n\t}\n\n\tgetTimestamp() {\n\t\treturn Math.floor(Date.now() / 1000);\n\t}\n\n\tgetFriends() {\n\t\tconnect.send('VKWebAppCallAPIMethod', {\n\t\t\t'method': 'friends.get',\n\t\t\t'request_id': '1fr',\n\t\t\t'params': {\n\t\t\t\t'fields': 'city,country,domain,first_name,last_name,photo_100,photo_200',\n\t\t\t\t'count': 1000,\n\t\t\t\t'order': 'mobile',\n\t\t\t\t'access_token': this.state.vkAccessToken,\n\t\t\t\t'v': '5.101',\n\t\t\t}\n\t\t});\n\t}\n\n\tgetGroups = () => {\n\t\tconnect.send('VKWebAppCallAPIMethod', {\n\t\t\t'method': 'groups.get',\n\t\t\t'request_id': '1gr',\n\t\t\t'params': {\n\t\t\t\t'fields': 'city,country,place,description,members_count,links,site,is_favorite,photo_100,photo_200',\n\t\t\t\t'count': 1000,\n\t\t\t\t'extended': true,\n\t\t\t\t'access_token': this.state.vkAccessToken,\n\t\t\t\t'v': '5.101',\n\t\t\t}\n\t\t});\n\t}\n\n\tgetToken = () => {\n\t\tconnect.send('VKWebAppGetAuthToken', {'app_id': 7150409, 'scope': 'friends,groups'});\n\t}\n\n\tonPanelChange (e) {\n\t\tthis.setState({\n\t\t\tactivePanel: e.currentTarget.dataset.panel\n\t\t});\n\t}\n\n\tonRefresh = () => {\n\t\t// this.setState({ fetching: true });\n\n\t\t// console.log('REFRESH');\n  \n\t\t// setTimeout(() => {\n\t\t// \tthis.setState({\n\t\t// \t\tfetching: false\n\t\t// \t});\n\t\t// });\n\t}\n\n\tonStoryChange (e) {\n\t\tthis.setState({ activeStory: e.currentTarget.dataset.story });\n\t}\n\n\tonViewChange (e) {\n\t\tthis.setState({ activeView: e.currentTarget.dataset.view });\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<ConfigProvider isWebView={true}>\n\t\t\t\t<Epic \n\t\t\t\t\tactiveStory={this.state.activeStory} \n\t\t\t\t\ttabbar={\n\t\t\t\t\t\t<Tabbar>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={this.onStoryChange}\n\t\t\t\t\t\t\t\tselected={this.state.activeStory === 'discover'}\n\t\t\t\t\t\t\t\tdata-story=\"discover\"\n\t\t\t\t\t\t\t\ttext=\"Актуальное\"\n\t\t\t\t\t\t\t><Icon28Newsfeed /></TabbarItem>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={this.onStoryChange}\n\t\t\t\t\t\t\t\tselected={this.state.activeStory === 'friends'}\n\t\t\t\t\t\t\t\tdata-story=\"friends\"\n\t\t\t\t\t\t\t\ttext=\"Друзья\"\n\t\t\t\t\t\t\t><Icon28Users /></TabbarItem>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={this.onStoryChange}\n\t\t\t\t\t\t\t\tselected={this.state.activeStory === 'profile'}\n\t\t\t\t\t\t\t\tdata-story=\"profile\"\n\t\t\t\t\t\t\t\ttext=\"Профиль\"\n\t\t\t\t\t\t\t><Icon28User /></TabbarItem>\n\t\t\t\t\t\t</Tabbar>\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t<View id=\"discover\" activePanel=\"discover\">\n\t\t\t\t\t\t<Panel id=\"discover\">\n\t\t\t\t\t\t\t<PanelHeader>\n\t\t\t\t\t\t\t\t{ APP_NAME }\n\t\t\t\t\t\t\t</PanelHeader>\n\t\t\t\t\t\t\t<PullToRefresh onRefresh={this.onRefresh}>\n\t\t\t\t\t\t\t\t{(this.state.userDiscoverFeed.length === 0 && this.getAppRuntime() <= 10) && \n\t\t\t\t\t\t\t\t\t<Group style={{paddingTop: '20px'}}>\n\t\t\t\t\t\t\t\t\t\t<Spinner size=\"medium\" style={{ marginTop: 20 }} />\n\t\t\t\t\t\t\t\t\t\t<Div style={{textAlign: 'center'}}>\n\t\t\t\t\t\t\t\t\t\t\tМы подбираем интересные места для Вас, это может занять какое-то время\n\t\t\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t{(this.state.userDiscoverFeed.length === 0 && this.getAppRuntime() > 10) && \n\t\t\t\t\t\t\t\t\t<Group style={{paddingTop: '20px'}}>\n\t\t\t\t\t\t\t\t\t\t<Div style={{textAlign: 'center'}}>\n\t\t\t\t\t\t\t\t\t\t\tУпс, что-то пошло не так (\n\t\t\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t<Group>\n\t\t\t\t\t\t\t\t\t<List>\n\t\t\t\t\t\t\t\t\t\t{this.state.userDiscoverFeed.map((item, i) => \n\t\t\t\t\t\t\t\t\t\t\t<Group key={i} title={ item.name }>\n\t\t\t\t\t\t\t\t\t\t\t\t<Gallery\n\t\t\t\t\t\t\t\t\t\t\t\t\tslideWidth=\"90%\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ height: 150 }}\n\t\t\t\t\t\t\t\t\t\t\t\t\tbullets=\"dark\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ backgroundColor: 'var(--destructive)' }} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ backgroundColor: 'var(--button_commerce_background)' }} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{ backgroundColor: 'var(--accent)' }} />\n\t\t\t\t\t\t\t\t\t\t\t\t</Gallery>\n\t\t\t\t\t\t\t\t\t\t\t\t<Cell description={ item.description } />\n\t\t\t\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t</PullToRefresh>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t</View>\n\n\t\t\t\t\t<View id=\"friends\" activePanel=\"friends\">\n\t\t\t\t\t\t<Panel id=\"friends\">\n\t\t\t\t\t\t\t<PanelHeader>\n\t\t\t\t\t\t\t\t{ APP_NAME }\n\t\t\t\t\t\t\t</PanelHeader>\n\t\t\t\t\t\t\t<Group>\n\t\t\t\t\t\t\t\t<List>\n\t\t\t\t\t\t\t\t\t{this.state.userFriendsInApp.map((item, i) => \n\t\t\t\t\t\t\t\t\t\t<Div key={i}>\n\t\t\t\t\t\t\t\t\t\t\t<Cell before={<Avatar src={ item.photo_200 } />}>\n\t\t\t\t\t\t\t\t\t\t\t\t<span style={{\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: '#3a3a3a',\n\t\t\t\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ item.first_name + ' ' + item.last_name }\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t<span style={{color: '#9a9a9a'}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t1 уровень\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t</View>\n\n\t\t\t\t\t<View id=\"profile\" activePanel=\"profile\">\n\t\t\t\t\t\t<Panel id=\"profile\">\n\t\t\t\t\t\t\t<PanelHeader>\n\t\t\t\t\t\t\t\t{ APP_NAME }\n\t\t\t\t\t\t\t</PanelHeader>\n\t\t\t\t\t\t\t{this.state.fetchedUser &&\n\t\t\t\t\t\t\t\t<Group>\n\t\t\t\t\t\t\t\t\t<List>\n\t\t\t\t\t\t\t\t\t\t<Div>\n\t\t\t\t\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\t\t\t\t\tbefore={this.state.fetchedUser.photo_200 ? <Avatar src={this.state.fetchedUser.photo_200}/> : <Avatar><Icon28User /></Avatar>}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<span style={{\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: '#3a3a3a',\n\t\t\t\t\t\t\t\t\t\t\t\t}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{`${this.state.fetchedUser.first_name} ${this.state.fetchedUser.last_name}`}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t<span style={{color: '#9a9a9a'}}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t1 уровень\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t\t\t\t\t\t</Cell>\n\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t</View>\n\t\t\t\t</Epic>\n\t\t\t</ConfigProvider>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/features/map';\nimport 'core-js/features/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vk-connect';\nimport App from './App';\n//import registerServiceWorker from './sw';\n\n// Init VK  Mini App\nconnect.send('VKWebAppInit');\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\n//registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}